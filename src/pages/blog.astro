---
import RSSButton from "../components/RSSButton.astro";
import type { Props as SEOProps } from "../layouts/Layout.astro";
import MainLayout from "../layouts/MainLayout.astro";

const posts = (await Astro.glob("./blog/*.{md,mdx}")).sort(
  (a, b) =>
    new Date(b.frontmatter.pubDate).valueOf() -
    new Date(a.frontmatter.pubDate).valueOf()
);

const seo: SEOProps = {
  seo: {
    title: `Jan Gradič blog`,
    description: "Jan Gradič blog",
    openGraph: {
      basic: {
        title: "Jan Gradič blog",
        image: "/og.png",
        type: "website",
      },
      image: {
        width: 1200,
        height: 630,
        type: "image/png",
        alt: "Hey! I'm Jan, a full stack web developer.",
      },
    },
  },
};
---

<MainLayout {...seo}>
  <main class="prose lg:prose-lg xl:prose-xl dark:prose-invert m-auto">
    <div class="flex justify-between">
      <h1>Blog</h1>
      <RSSButton />
    </div>
    {
      posts.map((post) => (
        <div class="mb-16 lg:mb-20">
          <a href={post.url}>
            <img
              src={post.frontmatter.heroImage}
              alt={post.frontmatter.title}
            />
          </a>
          <a href={post.url} class="no-underline">
            <h2>{post.frontmatter.title}</h2>
          </a>
          <p>{post.frontmatter.description}</p>
          <div class="flex justify-between xsm:items-center xsm:flex-row flex-col-reverse">
            <a href={post.url} class="mt-4 xsm:mt-0">
              Read more
            </a>
            <time datetime={post.frontmatter.pubDate}>
              {new Date(post.frontmatter.pubDate).toLocaleDateString("en-us", {
                day: "2-digit",
                month: "long",
                year: "numeric",
              })}
            </time>
          </div>
        </div>
      ))
    }
  </main>
</MainLayout>
